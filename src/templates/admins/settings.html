{% extends "admins/base.html" %}

{% block title %}Settings Â· Copy SVG Translation{% endblock %}

{% block contents %}
<div class="card">
    <div class="card-header">
        <h3 class="headline">Application Settings</h3>
    </div>
    <div class="card-body">

        <div class="card mb-4 shadow-sm">
            <div class="card-header text-bg-light">
                <h5 class="mb-0 mt-1">Add New Setting</h5>
            </div>
            <div class="card-body">
                <form method="post" action="{{ url_for('admin.settings_create') }}" class="row g-3">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <div class="col-md-4">
                        <label class="form-label" for="new-setting-key">Key <small class="text-muted">(Code reference)</small></label>
                        <input type="text" name="key" class="form-control" id="new-setting-key" placeholder="e.g. enable_feature_x" required>
                    </div>
                    <div class="col-md-4">
                        <label class="form-label" for="new-setting-title">Title <small class="text-muted">(Display name)</small></label>
                        <input type="text" name="title" class="form-control" id="new-setting-title" placeholder="Enable Feature X" required>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label" for="new-setting-type">Value Type</label>
                        <select name="value_type" id="new-setting-type" class="form-select">
                            <option value="boolean" selected>Boolean (True/False)</option>
                            <option value="string">String</option>
                            <option value="integer">Integer</option>
                            <option value="json">JSON</option>
                        </select>
                    </div>
                    <div class="col-md-1 d-flex align-items-end">
                        <button type="submit" class="btn btn-primary w-100">
                            <i class="bi bi-plus-lg"></i> Add
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div class="card shadow-sm">
            <div class="card-header text-bg-light">
                <h5 class="mb-0 mt-1">Manage Settings</h5>
            </div>
            <div class="card-body">
                <form method="post" action="{{ url_for('admin.settings_update') }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>

                    <div class="table-responsive">
                        <table class="table table-hover align-middle mb-4">
                            <thead class="table-light">
                                <tr>
                                    <th scope="col" style="width: 25%">Title</th>
                                    <th scope="col" style="width: 20%">Key</th>
                                    <th scope="col">Value</th>
                                    <th scope="col" style="width: 15%">Type</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for s in settings_list %}
                                <tr>
                                    <td><strong>{{ s.title }}</strong></td>
                                    <td><code class="text-muted">{{ s.key }}</code></td>
                                    <td>
                                        {% if s.value_type == 'boolean' %}
                                            <div class="form-check form-switch fs-5">
                                                <input class="form-check-input" type="checkbox" role="switch"
                                                    name="setting_{{ s.key }}" id="setting_{{ s.key }}"
                                                    {% if s.value == 'true' %}checked{% endif %}>
                                                <label class="form-check-label visually-hidden" for="setting_{{ s.key }}">Toggle {{ s.title }}</label>
                                            </div>
                                        {% elif s.value_type == 'integer' %}
                                            <input type="number" class="form-control" name="setting_{{ s.key }}" value="{{ s.value }}" required>
                                        {% elif s.value_type == 'json' %}
                                            <textarea class="form-control font-monospace form-control-sm" name="setting_{{ s.key }}" rows="3">{{ s.value }}</textarea>
                                        {% else %}
                                            <input type="text" class="form-control" name="setting_{{ s.key }}" value="{{ s.value }}">
                                        {% endif %}
                                    </td>
                                    <td><span class="badge bg-secondary">{{ s.value_type }}</span></td>
                                </tr>
                                {% else %}
                                <tr>
                                    <td colspan="4" class="text-center text-muted py-4">No settings configured yet.</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>

                    {% if settings_list %}
                    <div class="text-end">
                        <button type="submit" class="btn btn-success px-4">
                            <i class="bi bi-save"></i> Save All Settings
                        </button>
                    </div>
                    {% endif %}
                </form>
            </div>
        </div>

    </div>
</div>
{% endblock %}
